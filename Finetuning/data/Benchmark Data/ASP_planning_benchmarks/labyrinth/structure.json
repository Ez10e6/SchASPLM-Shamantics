{
  "instance_template": "dir(\"n\"). dir(\"s\"). dir(\"e\"). dir(\"w\").\ninverse(\"n\",\"s\"). inverse(\"s\",\"n\").\ninverse(\"e\",\"w\"). inverse(\"w\",\"e\").",
  "generator": "row(X) :- field(X,Y).\ncol(Y) :- field(X,Y).\nnum_rows(R) :- R = #max { X : row(X) }.\nnum_cols(C) :- C = #max { Y : col(Y) }.\nstep(1..S) :- max_steps(S).\nshift_neighbor(\"e\", X, Y, X, Y+1) :- field(X, Y), field(X, Y+1).\nshift_neighbor(\"e\", X, C, X, 1) :- field(X, C), num_cols(C).\nshift_neighbor(\"w\", X, Y, X, Y-1) :- field(X, Y), field(X, Y-1).\nshift_neighbor(\"w\", X, 1, X, C) :- field(X, 1), num_cols(C).\nshift_neighbor(\"s\", X, Y, X+1, Y) :- field(X, Y), field(X+1, Y).\nshift_neighbor(\"s\", R, Y, 1, Y) :- field(R, Y), num_rows(R).\nshift_neighbor(\"n\", X, Y, X-1, Y) :- field(X, Y), field(X-1, Y).\nshift_neighbor(\"n\", 1, Y, R, Y) :- field(1, Y), num_rows(R).\nadj(\"n\", X, Y, X-1, Y) :- field(X,Y), field(X-1,Y).\nadj(\"s\", X, Y, X+1, Y) :- field(X,Y), field(X+1,Y).\nadj(\"w\", X, Y, X, Y-1) :- field(X,Y), field(X,Y-1).\nadj(\"e\", X, Y, X, Y+1) :- field(X,Y), field(X,Y+1).\n{ push(R, \"e\", T) : row(R); push(R, \"w\", T) : row(R); push(C, \"n\", T) : col(C); push(C, \"s\", T) : col(C) } = 1 :- step(T), not reached_goal(T-1).\nreached_goal(0) :- goal_on(X,Y), init_on(X,Y).\nreached_goal(T) :- reached_goal(T-1), step(T).\nreached_goal(T) :- goal(X,Y,T), reach(X,Y,T), step(T).\nrow_pushed(X, T) :- push(X, \"e\", T).\nrow_pushed(X, T) :- push(X, \"w\", T).\ncol_pushed(Y, T) :- push(Y, \"n\", T).\ncol_pushed(Y, T) :- push(Y, \"s\", T).\nshift(X, Y, NX, NY, T) :- shift_neighbor(D, X, Y, NX, NY), push(X, D, T), row(X).\nshift(X, Y, NX, NY, T) :- shift_neighbor(D, X, Y, NX, NY), push(Y, D, T), col(Y).\nshift(X, Y, X, Y, T) :- field(X, Y), step(T), not row_pushed(X, T), not col_pushed(Y, T).\nconn(X,Y,D,0) :- connect(X,Y,D).\nconn(NX,NY,D,T) :- conn(X,Y,D,T-1), shift(X,Y,NX,NY,T).\ngoal(X,Y,0) :- goal_on(X,Y).\ngoal(NX,NY,T) :- goal(X,Y,T-1), shift(X,Y,NX,NY,T).\nreach(X,Y,0) :- init_on(X,Y).\nreach(NX,NY,T) :- reach(X,Y,T-1), shift(X,Y,NX,NY,T).\nreach(X2,Y2,T) :- reach(X1,Y1,T), adj(D,X1,Y1,X2,Y2), conn(X1,Y1,D,T), conn(X2,Y2,E,T), inverse(D,E).",
  "hard_constraints": [
    {
      "description": "Gotta make sure the goal field is actually reachable by the time we're done.",
      "asp_rule": ":- not reached_goal(M), M = #max { T : step(T) }."
    }
  ],
  "soft_constraints": [
    {
      "description": "Let's try to finish this in as few moves as possible.",
      "asp_rule": "penalty(\"step\", (X,D,T), 1) :- push(X,D,T)."
    }
  ],
  "global_objective": "#minimize { C,T,Name : penalty(Name,T,C) }."
}