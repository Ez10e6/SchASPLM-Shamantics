{
  "instance_template": "loc(\"LaunchPad\"; \"StationA\"; \"StationB\"; \"StationC\"; \"Tunnel1\"; \"Tunnel2\"; \"Tunnel3\"; \"CalibEdge\").\nstation(\"StationA\"; \"StationB\"; \"StationC\").\nmandatory(\"StationA\"; \"StationB\").\nedge(\"LaunchPad\", \"Tunnel1\", 2).\nedge(\"LaunchPad\", \"Tunnel2\", 3).\nedge(\"Tunnel1\", \"StationA\", 1).\nedge(\"StationA\", \"Tunnel3\", 1).\nedge(\"Tunnel3\", \"Tunnel2\", 3).\nedge(\"Tunnel2\", \"StationB\", 1).\nedge(\"Tunnel2\", \"CalibEdge\", 2).\nedge(\"CalibEdge\", \"StationC\", 1).\nedge(\"StationC\", \"Tunnel1\", 2).",
  "generator": "at(0, \"LaunchPad\").\ntime(0, 0).\nfuel(0, 16).\n{ action(S, move, L2) : edge(L1, L2, C); action(S, sample, L1) : station(L1); action(S, refill, L1) : L1 == \"CalibEdge\" } 1 :- at(S-1, L1), S = 1..18, T_prev < 10, time(S-1, T_prev).\nat(S, L) :- action(S, move, L).\nat(S, L) :- action(S, sample, L).\nat(S, L) :- action(S, refill, L).\ntime(S, T+1) :- action(S, move, L), time(S-1, T).\ntime(S, T+1) :- action(S, sample, L), time(S-1, T).\ntime(S, T+2) :- action(S, refill, L), time(S-1, T).\nfuel(S, V-C) :- action(S, move, L2), at(S-1, L1), edge(L1, L2, C), fuel(S-1, V).\nfuel(S, V-1) :- action(S, sample, L), fuel(S-1, V).\nfuel(S, 16) :- action(S, refill, L), fuel(S-1, V), V2 = V+3, V2 >= 16.\nfuel(S, V2) :- action(S, refill, L), fuel(S-1, V), V2 = V+3, V2 < 16.",
  "hard_constraints": [
    {
      "description": "sanity check for the tank capacity, don't run dry or overflow.",
      "asp_rule": ":- fuel(S, V), V < 0.\n:- fuel(S, V), V > 16."
    },
    {
      "description": "must hit all the mandatory stations or the mission is a bust.",
      "asp_rule": "sampled(L) :- action(S, sample, L).\n:- mandatory(L), not sampled(L)."
    },
    {
      "description": "StationA has a hard deadline at minute 6.",
      "asp_rule": "sampled_at(L, T) :- action(S, sample, L), time(S, T).\n:- sampled_at(\"StationA\", T), T > 6."
    },
    {
      "description": "StationC's strict entry requirement: you only sample it if the main jobs finish by minute 8.",
      "asp_rule": "mandatory_finish(T) :- T = #max { Ts : sampled_at(L, Ts), mandatory(L) }.\n:- sampled(\"StationC\"), mandatory_finish(T), T > 8.\n:- not sampled(\"StationC\"), mandatory_finish(T), T <= 8."
    },
    {
      "description": "no double-dipping at the same station in a row, avoid that cross-contamination.",
      "asp_rule": ":- action(S, sample, L), action(S-1, sample, L)."
    },
    {
      "description": "mission must wrap up within 10 minutes total.",
      "asp_rule": ":- time(S, T), T > 10."
    },
    {
      "description": "limit on the total number of events because we don't have all day.",
      "asp_rule": "total_events(V) :- V = #count { S : action(S, _, _) }.\n:- total_events(V), V > 18."
    },
    {
      "description": "refill logic says only once for that sweet 3L boost.",
      "asp_rule": "refills(V) :- V = #count { S : action(S, refill, _) }.\n:- refills(V), V > 1."
    }
  ],
  "soft_constraints": [
    {
      "description": "more samples is better, let's aim high.",
      "asp_rule": "penalty(\"samples\", (), -Count) :- Count = #count { L : sampled(L) }."
    },
    {
      "description": "get the mandatory stuff done ASAP.",
      "asp_rule": "penalty(\"finish_time\", (), T) :- mandatory_finish(T)."
    }
  ],
  "global_objective": "#minimize { C@2,Name : penalty(Name, (), C), Name == \"samples\" }.\n#minimize { C@1,Name : penalty(Name, (), C), Name == \"finish_time\" }."
}